{# Head partial: metadata, favicons, CSS, theme preflight (external) #}
<head>
  <!-- Core meta -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="light dark" />
  <meta name="theme-color" content="#0b1220" media="(prefers-color-scheme: dark)" />
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)" />

  {# SEO basics #}
  <title>{{ title or site.title }}</title>
  {% set canon = page.url | url | absoluteUrl(site.url) %}
  <link rel="canonical" href="{{ canon }}" />

  {# Open Graph / Twitter #}
  <meta property="og:type" content="website" />
  <meta property="og:title" content="{{ title or site.title }}" />
  <meta property="og:description" content="{{ description or site.description }}" />
  <meta property="og:url" content="{{ canon }}" />
  {% if site.ogImage %}<meta property="og:image" content="{{ site.ogImage }}" />{% endif %}
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="{{ title or site.title }}" />
  <meta name="twitter:description" content="{{ description or site.description }}" />
  {% if site.ogImage %}<meta name="twitter:image" content="{{ site.ogImage }}" />{% endif %}

  {# Favicons #}
  <link rel="icon" type="image/png" href="/assets/images/BitCurrent-favicon.png" />
  <link rel="apple-touch-icon" href="/assets/images/BitCurrent-favicon.png" />

  {# Optional CDN preconnect #}
  {% if site.cdn %}
    <link rel="preconnect" href="{{ site.cdn }}" crossorigin />
  {% endif %}

  {# Theme preflight: external (no inline JS; avoids CSP violations).
     This must be before CSS so data-theme is set ahead of first paint. #}
  <script src="/assets/js/theme-preload.js?v={{ build.id }}"></script>

  {# Site CSS #}
  <link rel="stylesheet" href="/assets/css/smoke.css?v={{ build.id }}" />

  {% block head_extra %}{% endblock %}

  {# Theme runtime: handles toggle; CSP-safe because it's an external file.
     'defer' waits until DOM is parsed while not blocking paint. #}
  <script src="/assets/js/theme.js?v={{ build.id }}" defer></script>
</head>